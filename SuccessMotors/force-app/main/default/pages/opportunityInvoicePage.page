<apex:page standardController="opportunity" extensions="OpportunityInvoicePageController" renderAs="pdf" applyHtmlTag="false" applyBodyTag="false" showHeader="false">
    <html>
        <head>
            <style>
                body {
                    font-family: Georgia, 'Times New Roman', Times, serif;
                    font-weight: normal;
                }

                .top-bar {
                    background-color: rgb(255, 42, 42);
                    height: 20px;
                    width: 100%;
                    position: fixed;
                    top: 0;
                }

                .bottom-bar {
                    background-color: rgb(255, 42, 42);
                    height: 20px;
                    width: 100%;
                    position: fixed;
                    bottom: 0;
                    text-align: center;
                    color: white;
                }

                .company-container {
                    position: fixed;
                    background-color: #eeeeee; 
                    width: 100%;
                    margin-top: 10px;
                    padding-top: 30px;
                    padding-left: 50px;
                    padding-bottom: 20px;
                    
                }

                .company-info {
                    float: left;
                    width: 50%;
                }

                .company-info-details {
                    margin-left: 100px;
                }

                .company-info-details h3 {
                    margin: 0px;
                    font-size: 16px;
                    color:rgb(70, 70, 70);
                }

                .company-info-address {
                    margin-top: 2px;
                    margin-bottom: 0px;
                    font-size: 12px;
                    color:rgb(70, 70, 70);
                }

                .company-info-contact-info {
                    margin-top: 5px;
                    font-size: 12px;
                    color:rgb(70, 70, 70);
                    /* margin-bottom: 90px; */
                }

                .company-logo {
                    float: left;
                    border: 2px solid #505050;
                }

                .order-info {
                    float: right;
                    width: 50%;
                    text-align: center;
                    margin-right: -30px;
                }

                .order-info h2 {
                    font-size: 20px;
                    color:rgb(136, 136, 136);
                }

                .order-info h5 {
                    font-size: 12px;
                    margin-top: 25px;
                    color: rgb(31, 24, 99);
                    position: relative;
                }

                .order-info h5::after {
                    content: "";
                    display: block;
                    width: 100px; 
                    height: 1px; 
                    background-color: rgb(77, 34, 134); 
                    position: absolute;
                    bottom: -4px;
                    left: 130px;
                }

                .contact-info-container {
                    position: fixed;
                    margin-left: 50px;
                    margin-right: 50px;
                    margin-top: 200px;
                }

                .contact-info {
                    float: left;
                    width: 100%;
                }

                .contact-info p {
                    margin-top: 7px;
                    margin-bottom: 0px;
                    font-size: 14px;
                }

                .contact-info h5 {
                    font-size: 12px;
                    color: rgb(31, 24, 99);
                    position: relative;
                    margin-bottom: 13px;
                }

                .contact-info h5::after {
                    content: "";
                    display: block;
                    width: 100%; 
                    height: 1px; 
                    background-color: rgb(77, 34, 134); 
                    position: absolute;
                    bottom: -4px;
                    left: 0;
                }

                .product-table-container {
                    position: fixed;
                    width: 100%;
                    margin-top: 370px;
                }

                .product-table {
                    width: 87%;
                    margin: 0 auto;
                    margin-top: 5px;
                    margin-bottom: 0px;
                    border-collapse: collapse;
                }

                .product-table th {
                    text-align: center;
                    color: white;
                    background-color: rgb(255, 42, 42);
                    font-size: 14px;
                    padding-top: 3px;
                    padding-bottom: 3px;
                }

                .product-table td {
                    text-align: center;
                    border-bottom: 1px solid black;
                    padding-top: 3px;
                    padding-bottom: 3px;
                    font-size: 13px;
                }

                .balance-table {
                    width: 87%;
                    margin: 0 auto;
                    border-collapse: collapse;
                    margin-top: 0px;
                }

                .balance-text {
                    width: 20%;
                    text-align: right;
                    color: rgb(31, 24, 99);
                    font-size: 15px;
                    padding-top: 10px;
                    padding-bottom: 10px;
                }

                .balance-number {
                    width: 20%;
                    text-align: center;
                    background-color: rgb(252, 190, 190);
                    border-bottom: 1px solid black;
                    border-top: 1px solid black;
                    padding-top: 10px;
                    padding-bottom: 10px;
                    font-size: 17px;
                }

            </style>
        </head>
        <body>
            <div class="top-bar"></div>

            <div class="company-container">
                <div class="company-info">
                    <img src="" alt="Logo" class="company-logo"></img>
                    <div class="company-info-details">
                        <h3>{!account.Name}</h3>
                        <p class="company-info-address">{!account.BillingStreet}, {!account.BillingCity}, {!account.BillingState}, {!account.BillingPostalCode}, {!account.BillingCountry}</p>
                        <p class="company-info-contact-info">{!opportunityOwner}</p>
                    </div>
                </div>
                <div class="order-info">
                    <h2>INVOICE</h2>
                    <h5>{!invoiceDate}</h5>
                    <h5>{!oppt.Invoice_Number__c}</h5>
                </div>
            </div>

            <div class="contact-info-container">
                <div class="contact-info">
                    <h5>BILL TO</h5>
                    <p>{!contact[0].Contact.Name}</p>
                    <p>{!contact[0].Contact.Account.Name}</p>
                    <p>{!contact[0].Contact.Phone}</p>
                    <p>{!contact[0].Contact.Email}</p>
                </div>
            </div>

            <div class="product-table-container">
                <table class="product-table">
                    <thead>
                        <tr>
                            <th style="width: 40%;">PRODUCT NAME</th>
                            <th style="width: 20%;">QTY</th>
                            <th style="width: 20%;">UNIT PRICE</th>
                            <th style="width: 20%;">TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <apex:repeat value="{!opportunityProducts}" var="product">
                            <tr>
                                <td style="text-align: left;">{!product.Name}</td>
                                <td>{!product.Quantity}</td>
                                <td>{!product.UnitPrice}</td>
                                <td>{!product.TotalPrice}</td>
                            </tr>
                        </apex:repeat>
                    </tbody>
                </table>
                <table class="balance-table">
                    <thead>
                        <tr>
                            <th style="width: 40%;"></th>
                            <th style="width: 20%;"></th>
                            <th class="balance-text">Balance Due</th>
                            <th class="balance-number">{!totalBalance}</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <!-- <div class="bottom-bar">{!account.Name}</div> -->
        </body>
    </html>

</apex:page> 